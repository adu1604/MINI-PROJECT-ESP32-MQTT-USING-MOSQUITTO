Step-by-Step Mosquitto MQTT Broker Setup and Testing
Step 1Ô∏è‚É£: Download Mosquitto

Open the official Mosquitto website:
üëâ https://mosquitto.org/download/

Download the Windows installer:

mosquitto-2.x.x-install-windows-x64.exe


During installation, make sure to select:

‚úÖ Install as service

‚úÖ Add Mosquitto to PATH

Step 2Ô∏è‚É£: Configure Mosquitto

Open the following file as Administrator:

C:\Program Files\mosquitto\mosquitto.conf


Delete everything inside the file.

Paste only the following configuration:

# ===== Mosquitto minimal config for ESP32 =====

listener 1883
allow_anonymous true

log_type all


Save and close the file.
(No bind_address, no extra listeners, no duplicate entries.)

Step 3Ô∏è‚É£: Find PC IP Address

Open Command Prompt.

Run:

ipconfig


Copy the IPv4 address of your active Wi-Fi network.

Paste this IP address into the ESP32 config.h file:

MQTT_BROKER = "<PC_IP_ADDRESS>"
MQTT_PORT   = 1883

CMD‚Äì1: Start Mosquitto Broker
Step 4Ô∏è‚É£: Stop Existing Mosquitto Service

Open CMD as Administrator.

Run:

net stop mosquitto

Step 5Ô∏è‚É£: Kill Any Running Mosquitto Process

Check for running Mosquitto processes:

tasklist | findstr mosquitto


If found, kill the process:

taskkill /F /IM mosquitto.exe

Step 6Ô∏è‚É£: Start Mosquitto with Config File

Navigate to Mosquitto directory:

cd "C:\Program Files\mosquitto"


Start Mosquitto:

mosquitto -v -c "C:\Program Files\mosquitto\mosquitto.conf"


Expected Output:

mosquitto version 2.0.22 starting
Config loaded from C:\Program Files\mosquitto\mosquitto.conf.
Opening ipv4 listen socket on port 1883.
Opening ipv6 listen socket on port 1883.

CMD‚Äì2: Verify Broker Status
Step 7Ô∏è‚É£: Verify Listening Address

Open a new Command Prompt.

Run:

netstat -ano | findstr 1883


Expected Output:

TCP 0.0.0.0:1883   LISTENING


‚úÖ If this appears, the broker is ready for ESP32 connection.

Step 8Ô∏è‚É£: Start Subscriber

In the same CMD window:

mosquitto_sub -h <PC_IP_ADDRESS> -t test


The command will wait for messages (no output initially).

CMD‚Äì3: Test Publisher
Step 9Ô∏è‚É£: Publish Test Message

Open another Command Prompt.

Navigate to Mosquitto folder:

cd "C:\Program Files\mosquitto"


Publish a message:

mosquitto_pub -h <PC_IP_ADDRESS> -t test -m hello

Step üîü: Verify Message Reception

Switch back to CMD‚Äì2 (Subscriber).

You should see:

test hello


‚úÖ This confirms that publisher and subscriber are working correctly using the Mosquitto broker.

Final Result

Mosquitto broker is configured successfully

Publisher and subscriber communication is verified

System is ready for ESP32 MQTT integration
